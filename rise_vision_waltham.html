<!DOCTYPE html>
<html>
<head lang="en">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <title></title>
    <style>
        html, body { 
            height: 100%; 
            margin: 0;
            overflow-y: hidden;
            overflow-x: hidden;
        }
        body {
            background-color: #6d9eebff;
            padding: 2%;
        }
        .all {
            height: 100%;  
            margin: 0; 
        }
        .logo {
            width: 40%;
        }
        .header_container {
        }
        .header {
            color: #073763;
            font-size: 130px;
        }
        .image {
            display: inline-block;
            width: 20%;
            vertical-align: top;
        }
        .title {
            display: inline-block;
            width: 59%;
            text-align: center;
            vertical-align: top;
        }
        .clock {
            display: inline-block;
            width: 20%;
            margin-top: 1em;
            vertical-align: top;
            text-align: center;
        }
        .clockContainer {
            background: white;
            border: 2px solid #073763;
            padding: 2%;
            width: 75%;
            float: right;
            
        }
        #date {
            font-size: 25px;
        }
        #time {
            font-size: 40px;
            width: 100%;
        }
        .main {
           margin: auto;
           width: 100%;
           padding-top: 2%;
           height: 57%;
           overflow: hidden;
        }
        .table_one {
            background-color: white;
            padding: 2%;
            border: 2px solid #073763;
            display: inline-block;
            width: 42%;
            height: 85%;
            vertical-align: top;
            margin: .5%;
        }
        #table_two {
            background-color: white;
            padding: 2%;
            border: 2px solid #073763;
            display: inline-block;
            width: 42%;
            height: 85%;
            vertical-align: top;
            margin: .5%;
            float: right;
            overflow:hidden;
        }
        #schedule {
            vertical-align: top;
            width: 100%;
        }
        #announcements {
            vertical-align: top;
            width: 100%;
            min-height: 50%;
        }
        th {
            color: #073763;
            font-size: 40px;
            padding-bottom: 2%;
            text-align: center;
            border-bottom: 2px solid #073763;
            min-width: 100%;
        }
        td {
            font-size: 30px;
            color: #073763;
            max-height: 2em;
        }
        thead > tr {
            width: 100%;
        }
        #mainImg {
            max-width:100%;
            height: 100%;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .navigation {
            height: 10%;
        }
        .leftArrow {
            float: left;
            color: white;
            font-size: 50px;
            top: 0;
            font-weight: bold;
            margin-left: 1em;
            margin-top: 3%;
        }
        .rightArrow {
            float: right;
            color: white;
            font-size: 50px;
            top: 0;
            font-weight: bold;
            margin-right: 1em;
            margin-top: 3%;
        }
        .arrowLeft {
            float: left;
            color: white;
            font-size: 90px;
            top: 0;
            font-weight: bold;
            vertical-align: top;
            margin-top: 1.2%;
        }
        .arrowRight {
            float: right;
            color: white;
            font-size: 90px;
            top: 0;
            font-weight: bold;
            margin-top: 1.2%;
        }
        .footer {
            bottom: 0;
            position: fixed;
            left: 0;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="all">
    <div class="header_container">
        <div class="image">
            <img class="logo" src="http://i.imgur.com/xrAAez9.png">
        </div>
        <div class="title">
            <div class="header">The Carroll School</div>
        </div>
        <div class="clock">
            <div class="clockContainer">
            <!--
            <div class="cleanslate w24tz-current-time w24tz-middle"><p><a href="//24timezones.com/usa_time/ma_middlesex/waltham.php" 
            style="text-decoration: none" class="clock24" 
            id="tz24-1542631123-cu126229-eyJob3VydHlwZSI6IjEyIiwic2hvd2RhdGUiOiIxIiwic2hvd3NlY29uZHMiOiIwIiwiY29udGFpbmVyX2lkIjoiY2xvY2tfYmxvY2tfY2I1YmYyYWVkMzg2OTU1IiwidHlwZSI6ImRiIiwibGFuZyI6ImVuIn0=" 
            title="timezone - Waltham" target="_blank" rel="nofollow">Current time in Waltham</a></p><div id="clock_block_cb5bf2aed386955"></div></div>
            <script type="text/javascript" src="//w.24timezones.com/l.js" async></script>
            -->
                <div id="time"></div>
                <div id="date"></div>
            </div>
        </div> 
    </div>
    <div class="main">
        <div class="table_one">
        <table id="schedule">
            <thead>
                <tr>
                    <th colspan="2">Daily School Schedule</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
        </div>
        <div id="table_two">
        </div>
    </div>
    <div class="navigation">
        <div class="arrowLeft">←</div>
        <div class="leftArrow">Rooms 101 - 121, Great Hall</div>
        <div class="arrowRight">→</div>
        <div class="rightArrow">Gym, Rooms 120 - 147</div>
    </div>
    <div class="footer">
        <a class="weatherwidget-io" href="https://forecast7.com/en/42d38n71d24/waltham/?unit=us" data-label_1="Waltham, MA" data-label_2="WEATHER" 
        data-theme="original" >Waltham, MA WEATHER</a>
        <script>
        !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
        js.id=id;js.src='https://weatherwidget.io/js/widget.min.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','weatherwidget-io-js');
        </script>
    </div>
    </div>
    <script>
    
        var messageList = [];
        var calendarList = [];
        
        const onDataLoaded = (data) => {
            
            var option = "";
            try {
                option = data.feed.entry.find((entry) => entry.title.$t == "B8").content.$t;
            } catch (e) {
            }
            
            if(!(option == "1" || option == "2" || option == "3" || option == "4" || option == "5")) {
            
                document.getElementById('table_two').innerHTML = "<table id='announcements'><thead><tr><th colspan='2'>Announcements</th></tr></thead><tbody></tbody></table>";
            
                for(i = 1; i < 6; i++) {
                    var varOne = 'A' + (i+1);
                    var varTwo = 'B' + (i+1);
                
                    var itemOne = " ";  
                    var itemTwo = " ";  
                
                    try {
                        itemOne = data.feed.entry.find((entry) => entry.title.$t == varOne).content.$t;
                    } catch (e) {
                    }
                    try {
                        itemTwo = data.feed.entry.find((entry) => entry.title.$t == varTwo).content.$t;
                    } catch(e) {
                    }
                    messageList.push([itemOne,itemTwo]);
                }
            
                populateAnnouncements(messageList);
            } else {
                var optionCount = Number(option) + 8;
                var item;
                
                var element = "B" + optionCount.toString();
                
                try {
                    item = data.feed.entry.find((entry) => entry.title.$t == element).content.$t;
                    document.getElementById('table_two').innerHTML = "<img id='mainImg' src='" + item + "'>";
                } catch (e) {
                    document.getElementById('table_two').innerHTML = "<img id='mainImg' src='http://i.imgur.com/xrAAez9.png'>";
                }
                
            }
            
            var begin;
            
            var date = new Date();
            if(data.feed.entry.find((entry) => entry.title.$t == "B43").content.$t == "yes") {
                begin = 44;
            } else if(date.getDay() != 5) {
                begin = 16;
            } else {
                begin = 30;
            }
            
            for(j = begin; j < begin+12; j++) {
                var varOne = 'A' + j;
                var varTwo = 'B' + j;
                
                var itemOne = " ";  
                var itemTwo = " ";  
                
                try {
                    itemOne = data.feed.entry.find((entry) => entry.title.$t == varOne).content.$t;
                } catch (e) {
                }
                try {
                    itemTwo = data.feed.entry.find((entry) => entry.title.$t == varTwo).content.$t;
                } catch(e) {
                }
                calendarList.push([itemOne,itemTwo]);
            }
            
            populateCalendar(calendarList);
            
            startTime();
        }
        
        function populateAnnouncements(messageList) {
            var table = document.getElementById('announcements').getElementsByTagName('tbody')[0];
            for(i = 0; i < 5; i++) {
                var row = table.insertRow(i);
                var cell1 = row.insertCell(0);
                var cell2 = row.insertCell(1);
                var elements = messageList[i][0].split(" ");
                var elementOne = elements[0];
                var elementTwo = "";
                for(j = 1; j < elements.length; j++) {
                    elementTwo +=  elements[j] + " ";
                }
                cell1.innerHTML = elementOne + "<br>" + elementTwo
                cell2.innerHTML = messageList[i][1];
                cell1.style.width = "40%";
                cell2.style.height = "2.5em";
            }
        }
        
        function populateCalendar(calendarList) {
            var table = document.getElementById('schedule').getElementsByTagName('tbody')[0];
            
            for(i = 0; i < calendarList.length; i++) {
                var row = table.insertRow(i);
                var cell1 = row.insertCell(0);
                var cell2 = row.insertCell(1);

                cell1.innerHTML = calendarList[i][0];
                cell2.innerHTML = calendarList[i][1];
                cell1.style.width = "40%";
            }
        }
        
        function startTime() {
            var today = new Date();
            var y = today.getFullYear();
            var mo = getMonth(today.getMonth());
            var d = today.getDate();
            var w = getDay(today.getDay());
            var ord = nth(d);
            
            var h;
            var ampm;
            if(today.getHours() > 12) {
                h = today.getHours() - 12;
                ampm = " PM"
            } else {
                h = today.getHours();
                ampm = " AM"
            }
            var m = today.getMinutes();
            m = checkTime(m);
            document.getElementById('date').innerHTML = 
            w + ",<br>" + mo + " " + d + ord + ", " + y; 
            document.getElementById('time').innerHTML =
            h + ":" + m + ampm;
            var t = setTimeout(startTime, 500);
        }
        function checkTime(i) {
            if (i < 10) {i = "0" + i};  // add zero in front of numbers < 10
            return i;
        }
        function getMonth(month) {
            var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            return(months[month]);
        }
        function getDay(day) {
            var days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            return(days[day]);
        }
        function nth(d) {
            if (d > 3 && d < 21) return 'th'; 
            switch (d % 10) {
                case 1:  return "st";
                case 2:  return "nd";
                case 3:  return "rd";
                default: return "th";
            }
        }
    </script>
    <script src="https://spreadsheets.google.com/feeds/cells/17j7Mz4ljmyjayxGt28PGftgE79yjRvV5WrH8TQsnRc0/1/public/basic?alt=json-in-script&callback=onDataLoaded"></script>
</body>
</html>
